(()=>{var e,t,a,n,o={31:(e,t,a)=>{"use strict";a.r(t)},204:(e,t,a)=>{var n={"./web.css":285};function o(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=r,e.exports=o,o.id=204},285:(e,t,a)=>{"use strict";a.r(t)},330:e=>{"use strict";e.exports={rE:"7.0.20"}},747:(e,t,a)=>{var n={"./nrShared.css":31};function o(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=r,e.exports=o,o.id=747}},r={};function l(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return o[e].call(a.exports,a,a.exports,l),a.exports}l.m=o,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"==typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"==typeof a.then)return a}var o=Object.create(null);l.r(o);var r={};e=e||[null,t({}),t([]),t(t)];for(var i=2&n&&a;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>r[e]=()=>a[e]));return r.default=()=>a,l.d(o,r),o},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,a)=>(l.f[a](e,t),t)),[])),l.u=e=>e+"-"+{23:"39fd6c11799ccebb0c3d",557:"3324c0cb1caca55dbf43",840:"ff37aad505da29f2dbb4"}[e]+".js",l.miniCssF=e=>e+"-151ac6e3de953295ad49.css",l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},n="netnr:",l.l=(e,t,o,r)=>{if(a[e])a[e].push(t);else{var i,s;if(void 0!==o)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var m=d[c];if(m.getAttribute("src")==e||m.getAttribute("data-webpack")==n+o){i=m;break}}i||(s=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",n+o),i.src=e),a[e]=[t];var u=(t,n)=>{i.onerror=i.onload=null,clearTimeout(h);var o=a[e];if(delete a[e],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((e=>e(n))),t)return t(n)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),s&&document.head.appendChild(i)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="/",(()=>{if("undefined"!=typeof document){var e=e=>new Promise(((t,a)=>{var n=l.miniCssF(e),o=l.p+n;if(((e,t)=>{for(var a=document.getElementsByTagName("link"),n=0;n<a.length;n++){var o=(l=a[n]).getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(o===e||o===t))return l}var r=document.getElementsByTagName("style");for(n=0;n<r.length;n++){var l;if((o=(l=r[n]).getAttribute("data-href"))===e||o===t)return l}})(n,o))return t();((e,t,a,n,o)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",l.nc&&(r.nonce=l.nc),r.onerror=r.onload=a=>{if(r.onerror=r.onload=null,"load"===a.type)n();else{var l=a&&a.type,i=a&&a.target&&a.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+l+": "+i+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=l,s.request=i,r.parentNode&&r.parentNode.removeChild(r),o(s)}},r.href=t,a?a.parentNode.insertBefore(r,a.nextSibling):document.head.appendChild(r)})(e,o,null,t,a)})),t={792:0};l.f.miniCss=(a,n)=>{t[a]?n.push(t[a]):0!==t[a]&&{307:1}[a]&&n.push(t[a]=e(a).then((()=>{t[a]=0}),(e=>{throw delete t[a],e})))}}})(),(()=>{var e={792:0};l.f.j=(t,a)=>{var n=l.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else if(307!=t){var o=new Promise(((a,o)=>n=e[t]=[a,o]));a.push(n[2]=o);var r=l.p+l.u(t),i=new Error;l.l(r,(a=>{if(l.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=a&&("load"===a.type?"missing":a.type),r=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",i.name="ChunkLoadError",i.type=o,i.request=r,n[1](i)}}),"chunk-"+t,t)}else e[t]=0};var t=(t,a)=>{var n,o,[r,i,s]=a,d=0;if(r.some((t=>0!==e[t]))){for(n in i)l.o(i,n)&&(l.m[n]=i[n]);if(s)s(l)}for(t&&t(a);d<r.length;d++)o=r[d],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0},a=self.webpackChunknetnr=self.webpackChunknetnr||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),(()=>{"use strict";let e={init:(t,a,n=document)=>{n.addEventListener("dragover",(e=>{a&&a.contains(e.target)||(e.preventDefault(),e.stopPropagation())})),n.addEventListener("drop",(async n=>{if(!a||!a.contains(n.target)){n.preventDefault();let a=await e.readDataTransferItems(n.dataTransfer.items);a.length&&await t(a,"drag")}})),a&&a.addEventListener("change",(async function(){let e=this.files;e.length&&await t(e,"change")})),document.addEventListener("paste",(async function(e){if(!["INPUT","TEXTAREA"].includes(e.target.nodeName)){let a=e.clipboardData.items,n=[];for(let e=0;e<a.length;e++){let t=a[e].getAsFile();t&&n.push(t)}n.length&&await t(n,"paste")}}))},readDataTransferItems:async t=>{let a=[],n=[];for(let o=0;o<t.length;o++){let r=t[o],l=r.webkitGetAsEntry();if(null!=l)a.push(e.readDataTransferItemEntry(l));else{let e=r.getAsFile();e&&n.push(e)}}return(await Promise.all(a)).forEach((e=>{e.length?n=n.concat(e):n.push(e)})),n},readDataTransferItemEntry:(t,a)=>new Promise((n=>{if(a=a||"",t.isFile)t.file((e=>{""!=a&&(e.fullPath=a+e.name),n(e)}));else if(t.isDirectory){t.createReader().readEntries((o=>{let r=[];for(let n=0;n<o.length;n++)r.push(e.readDataTransferItemEntry(o[n],a+t.name+"/"));Promise.all(r).then((e=>{let t=[];e.forEach((e=>{e.length?t=t.concat(e):t.push(e)})),n(t)}))}))}})),invokeCanvasToBlob:(e,t,a)=>new Promise((n=>{e.toBlob((e=>{n(e)}),t,a)})),invokeImageOnload:(e,t)=>new Promise((a=>{e.onload=()=>a(e),e.src=t})),reader:(e,t="Text",a="utf-8")=>new Promise(((n,o)=>{const r=new FileReader;r.onloadend=()=>n(r.result),r.onerror=()=>o(),"Text"==t?r.readAsText(e,a):r[`readAs${t}`](e)}))};Object.assign(window,{nrcFile:e});let t={version:l(330).rE,lastFetchDate:null,cookie:function(e,t,a){if(1==arguments.length){let t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?t[2]:null}{let n=`${e}=${t};Path=/`;if(a){let e=new Date;e.setTime(e.getTime()+a),n=`${n};Expires=${e.toGMTString()}`}document.cookie=n}},isDark:()=>document.cookie.includes(".theme=dark"),saveTheme:e=>{let t=new Date;t.setFullYear(t.getFullYear()+1),document.cookie=`.theme=${e};Path=/;Expires=${t.toGMTString()}`},isNullOrWhiteSpace:e=>null==e||""==e.toString().trim(),getFileNameWithoutExtension:e=>{var t=e.split(".");return t.length>1&&t.pop(),t.join(".")},UUID:()=>window.crypto&&window.crypto.randomUUID?crypto.randomUUID():URL.createObjectURL(new Blob([])).split("/").pop(),random:(e=99999,t=0)=>Math.floor(Math.random()*(e-t+1)+t),addSeconds:(e,t)=>(e.setSeconds(e.getSeconds()+t),e),addMinutes:(e,t)=>(e.setMinutes(e.getMinutes()+t),e),addHours:(e,t)=>(e.setHours(e.getHours()+t),e),addDays:(e,t)=>(e.setDate(e.getDate()+t),e),addMonths:(e,t)=>(e.setMonth(e.getMonth()+t),e),addYears:(e,t)=>(e.setFullYear(e.getFullYear()+t),e),type:function(e){return{}.toString.call(e).split(" ")[1].replace("]","")},clone:e=>window.structuredClone?window.structuredClone(e):JSON.parse(JSON.stringify(e)),sleep:e=>new Promise((t=>setTimeout((()=>t()),e||1e3))),trimStart:(e,t)=>{for(e=e.toString().trim();e.startsWith(t);)e=e.substring(t.length);return e},trimEnd:(e,t)=>{for(e=e.toString().trim();e.endsWith(t);)e=e.substring(0,e.length-t.length);return e},error:()=>{throw new Error("Fake Error")},dispatchEvent:(e,t)=>e.dispatchEvent(new Event(t)),cssvar:(e,t,a)=>{if(null==a)return getComputedStyle(e).getPropertyValue(t);e.style.setProperty(t,a)},xssOf:e=>{let t=window.DOMPurify;return t?t.sanitize(e,{ADD_ATTR:["password-toggle","clearable","variant","target"]}):(console.debug("DOMPurify not found"),e)},htmlOf:e=>String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/"/g,"&#x27;").replace(/\//g,"&#x2F;"),htmlEncode:e=>e.replace(/[\u00A0-\u9999<>\&]/g,(e=>"&#"+e.charCodeAt(0)+";")),htmlDecode:e=>{let t=document.createElement("div");return t.innerHTML=e,t.innerText},arrayDistinct:e=>Array.from(new Set(e)),groupBy:(e,t)=>Array.from(new Set(e.map(t))),isDanger:e=>/[^a-zA-Z0-9_]+/.test(e),dangerReplace:e=>e.replace(/[^a-zA-Z0-9_]+/g,""),escapeMarkdown:e=>null==e?"":`${e}`.replace(/[\*\_\[\]\#\+\-\!\`\|]/g,"\\$&").replace(/\n/g,"<br>").replace(/\r/g,""),isRiskFile:e=>{let a=!1;if(t.isNullOrWhiteSpace(e)||e.length>250||e.endsWith("."))a=!0;else{let t=e.split("."),n=t.length>1?t.pop().toLowerCase():"";(n.length>10||n.length>1&&"exe,msi,bat,sh,php,php3,asa,asp,aspx,css,htm,html,mhtml,js,jse,jsp,jspx,dll,so,jar,war,ear,ps1,psm1,pl,pm,py,pyc,pyo,rb".includes(n))&&(a=!0)}return a},humpToUnderline:e=>{let t=[];for(let a=0;a<e.length;a++){let n=e[a].toLowerCase(),o=e.charCodeAt(a);o>=65&&o<=90?t.push(`_${n}`):t.push(n)}return t.join("")},byteLength:e=>{let t=0;return Array.from(e).map((function(e){t+=e.charCodeAt(0)>255?2:1})),t},fromCommaToArray:e=>null==e||""==e.trim()?[]:e.split(","),fromKeyToURLParams:e=>{if("Object"==t.type(e))for(const t in e)null!==e[t]&&void 0!==e[t]||(e[t]="");return new URLSearchParams(e).toString()},fromFormToKey:e=>Object.fromEntries(t.fromFormToFormData(e)),fromFormToFormData:e=>{let t=new FormData(e);return e.querySelectorAll("sl-select[multiple]").forEach((e=>{e.name&&t.set(e.name,e.value.join())})),t},fromKeyToFormData:e=>{let t=new FormData;for(const a in e){null!==e[a]&&t.append(a,e[a])}return t},getUrlParams:(e,t)=>new URLSearchParams(t||location.search).get(e),findParentElement:(e,t)=>{let a=e;for(;null!=a;){if(t(a))return a;a=a.parentElement}return null},readDOM:(e,t,a,n)=>{e.querySelectorAll("*").forEach((e=>{if(e.classList.value.startsWith(t)){let o="dom";e.classList[0].substring(t.length+1).split("-").forEach((e=>o+=e.substring(0,1).toUpperCase()+e.substring(1))),1!=n&&o in a||(a[o]=e)}}))},editDOM:e=>{e.setAttribute("contenteditable",!0),e.setAttribute("spellcheck",!1)},parserDOM:(e,t)=>(t=t||"text/html",(new DOMParser).parseFromString(e,t)),fetch:async(e,a)=>{let n={resp:null,result:null,error:null};try{a=a||{method:"GET",Cache:"no-cache"};let o=await fetch(e,a);n.resp=o;try{switch(t.lastFetchDate=o.headers.get("date"),null!=t.lastFetchDate&&(t.lastFetchDate=t.formatDateTime("datetime",t.lastFetchDate)),a.type){case"text":n.result=await o.text();break;case"blob":n.result=await o.blob();break;case"buffer":n.result=await o.arrayBuffer();break;case"reader":n.result=o.body.getReader();break;default:n.result=await o.json()}}catch(e){if(o.ok)throw e}}catch(e){n.error=e}return n},tsLoaded:{},importArray:async e=>{let a=[],n={};for(let o=0;o<e.length;o++){let r=e[o];"Promise"==t.type(r)?a.push(r):(a.push(r.promise),n[o]=r.name)}let o=await Promise.all(a);for(let e in n){let t=o[e];"default"in t&&(t=t.default),Object.assign(window,{[n[e]]:t})}return o},importStyle:async e=>{e=t.mirrorNPM(e);let a=t.tsLoaded[e];return a||(t.tsLoaded[e]=a=new Promise((t=>{let a=!1;if(document.querySelectorAll("link").forEach((t=>{t.href&&t.href.includes(e)&&(a=!0)})),a)t();else{let a=document.createElement("LINK");a.href=e,a.rel="stylesheet","onload"in a?a.onload=()=>{t()}:t(),document.head.appendChild(a)}}))),a},importScript:async(e,a)=>{e=t.mirrorNPM(e);let n=t.tsLoaded[e];return n||(t.tsLoaded[e]=n=new Promise(((t,n)=>{let o,r=document.scripts;for(let t=0;t<r.length;t++){let a=r[t];if(a.src.includes(e)){o=a;break}}if(o)t();else{let o=document.createElement("SCRIPT");o.src=e,o.type=a||"text/javascript",o.onerror=function(e){n(e)},o.onload=function(){t()},document.head.appendChild(o)}}))),n},require:(e,a)=>new Promise((n=>{if(a in t.tsLoaded)n();else{let o=a.split(",");e=e.map((e=>t.mirrorNPM(e))),window.require(e,(function(){for(let e=0;e<arguments.length;e++)Object.assign(window,{[o[e].trim()]:arguments[e]});t.tsLoaded[a]=!0,n()}))}})),mirrorNPM:e=>{let t=/(https?:\/\/[\w.-]+)\/(.*)@([\d.]+)\/(.*)\.(\w+)/.exec(e);return null!=t&&(e=`https://ss.netnr.com/${t[2]}@${t[3]}/${t[4]}.${t[5]}`),e},tsBottomKeepHeight:40,setHeightFromBottom:(e,a)=>{let n=null==a?t.tsBottomKeepHeight:a,o=e.getBoundingClientRect().top+n;Object.assign(e.style,{height:`calc(100vh - ${o}px)`,minHeight:"200px"})},formatByteSize:function(e,t=2,a=1024){if(Math.abs(e)<a)return e+" B";const n=1e3==a?["KB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let o=-1;const r=10**t;do{e/=a,++o}while(Math.round(Math.abs(e)*r)/r>=a&&o<n.length-1);return(1*e.toFixed(t)).toString()+n[o]},formatDateTime:(e,a)=>{switch(t.type(a)){case"String":case"Number":{let e=new Date(a);isNaN(e)?a.includes("年")&&a.includes("月")&&a.includes("日")&&(e=new Date(a.replace(/年|月/g,"-").replace("日",""))):10==a.length&&e.setHours(0,0,0,0),a=e}break;case"Date":break;default:a=new Date}switch(e=e||"yyyy-MM-dd HH:mm:ss"){case"date":e="yyyy-MM-dd";break;case"time":e="HH:mm:ss";break;case"datetime":e="yyyy-MM-dd HH:mm:ss";break;case"datetime-local":e="yyyy-MM-ddTHH:mm"}return[["yyyy",a.getFullYear()],["MM",a.getMonth()+1],["dd",a.getDate()],["HH",a.getHours()],["mm",a.getMinutes()],["ss",a.getSeconds()],["fff",a.getMilliseconds()]].reduce(((e,t)=>e.replace(t[0],`${t[1]}`.padStart(t[0].length,"0"))),e)},now:()=>t.formatDateTime("datetime"),downloadBlob:function(e,a){let n=window.URL.createObjectURL(e);t.downloadUrl(n,a)},downloadCanvas:function(e,a,n,o){if(null==n){let e=a.split(".").pop().toLowerCase();"jpg"==e&&(e="jpeg"),n=`image/${e}`}let r;r="image/png"==n?e.toDataURL(n):e.toDataURL(n,o),t.downloadUrl(r,a)},downloadText:function(e,a,n){let o=new Blob([e],{type:n||"text/plain"}),r=window.URL.createObjectURL(o);t.downloadUrl(r,a)},downloadUrl:function(e,t){let a=document.createElement("a");a.href=e,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)},performance:()=>{if(window.performance){let e=window.performance.getEntries();for(const a of e)if("PerformanceNavigationTiming"==t.type(a)){console.debug(a);break}}},voice:function(e){if(console.debug(e),"function"==typeof SpeechSynthesisUtterance){let t=new SpeechSynthesisUtterance(e);t.lang="zh-CN",window.speechSynthesis.speak(t)}},notify:async e=>{if("granted"==await Notification.requestPermission())return new Notification(e.title||"消息",e);console.debug(e)},cyrb53:(e,t=0)=>{let a=3735928559^t,n=1103547991^t;for(let t,o=0;o<e.length;o++)t=e.charCodeAt(o),a=Math.imul(a^t,2654435761),n=Math.imul(n^t,1597334677);return a=Math.imul(a^a>>>16,2246822507),a^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(a^a>>>13,3266489909),(4294967296*(2097151&n)+(a>>>0)).toString(36).slice(0,6)},clipboard:async e=>{let t;if(navigator.clipboard)return t=null==e?await navigator.clipboard.readText():await navigator.clipboard.writeText(e),t;if(null!=e){let t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.opacity=0,document.body.appendChild(t),t.select(),window.document.execCommand("Copy"),t.remove(),e}return"不支持 unsupported"}};Object.assign(window,{nrcBase:t});class a{constructor(e={}){this.db=null,this.name=e.name||"localforage",this.storeName=e.storeName||"keyvaluepairs",this.version=e.version||2}init(){return new Promise(((e,t)=>{if(this.db)return void e(this);const a=window.indexedDB.open(this.name,this.version);a.onerror=()=>{t(a.error)},a.onupgradeneeded=()=>{const e=a.result;e.objectStoreNames.contains(this.storeName)||e.createObjectStore(this.storeName)},a.onsuccess=()=>{this.db=a.result,e(this)}}))}_performTransaction(e,t){return new Promise(((a,n)=>{const o=this.db.transaction(this.storeName,e),r=o.objectStore(this.storeName);o.oncomplete=()=>{a()},o.onerror=e=>{n(e.target.error)},t(r,a,n)}))}setItem(e,t){return this._performTransaction("readwrite",((a,n,o)=>{const r=a.put(t,e);r.onsuccess=()=>{n()},r.onerror=()=>{o(r.error)}}))}getItem(e){return this._performTransaction("readonly",((t,a,n)=>{const o=t.get(e);o.onsuccess=()=>{a(o.result)},o.onerror=()=>{n(o.error)}}))}removeItem(e){return this._performTransaction("readwrite",((t,a,n)=>{const o=t.delete(e);o.onsuccess=()=>{a()},o.onerror=()=>{n(o.error)}}))}keys(){return this._performTransaction("readonly",((e,t,a)=>{const n=e.getAllKeys();n.onsuccess=()=>{t(n.result)},n.onerror=()=>{a(n.error)}}))}clear(){return this._performTransaction("readwrite",((e,t,a)=>{const n=e.clear();n.onsuccess=()=>{t()},n.onerror=()=>{a(n.error)}}))}}Object.assign(window,{nrcIndexedDB:a});let n={init:async()=>{null==n.localforage&&(n.localforage=await(new a).init())},localforage:null,getItem:async e=>await n.localforage.getItem(e),setItem:async(e,t)=>await n.localforage.setItem(e,t),removeItem:async e=>await n.localforage.removeItem(e),keys:async()=>await n.localforage.keys(),clear:async()=>await n.localforage.clear(),setCache:async(e,t,a)=>{let o={data:t,flag:a,time:(new Date).toLocaleString()};await n.localforage.setItem(e,o)},getCache:async(e,t)=>{let a=await n.localforage.getItem(e);if(a){if("function"==typeof t?t(a.flag):a.flag==t)return a.data;await n.localforage.removeItem(e)}}};Object.assign(window,{nrcStorage:n});let o={tsEditor:null,tsEditor2:null,tsMd:null,tsGrid:null,tsLoadingHtml:'<div class="spinner-border m-3" role="status"><span class="visually-hidden">Loading...</span></div>',tsFailHtml:'<input type="text" readonly class="form-control-plaintext" value="网络错误">',setTheme:function(e){let a=document.documentElement,n="dark"==e?"light":"dark";a.className=a.className.replace(n,e),a.dataset.bsTheme=e,t.saveTheme(e);let r=t.isDark();window.monaco&&(r?monaco.editor.setTheme("vs-dark"):monaco.editor.setTheme("vs")),o.tsMd&&o.tsMd.toggleTheme(r?"dark":"light"),document.querySelectorAll(".nrg-grid, .nrg-chart, .nrg-tree, .nrg-json-editor, .uppy-Dashboard").forEach((t=>{if(t.classList.contains("nrg-grid"))r?(t.classList.remove("ag-theme-alpine"),t.classList.add("ag-theme-alpine-dark")):(t.classList.remove("ag-theme-alpine-dark"),t.classList.add("ag-theme-alpine"));else if(t.classList.contains("nrg-chart"))window.nrcECharts&&window.nrcECharts.setTheme(t);else if(t.classList.contains("nrg-tree")){let e=t.tree;e&&e.set_theme(r?"default-dark":"default")}else t.classList.contains("nrg-json-editor")?r?t.classList.add("jse-theme-dark"):t.classList.remove("jse-theme-dark"):t.classList.contains("uppy-Dashboard")&&(t.dataset.uppyTheme=e)}))},setLoading:(e,t=!1)=>{if(e.disabled=!t,t){e.classList.remove("nrg-loading");let t=e.querySelector(".nrg-loading-wait");t&&t.remove()}else if(!e.classList.contains("nrg-loading")){e.classList.add("nrg-loading");let t=document.createElement("span");t.className="nrg-loading-wait",t.innerHTML='<span class="spinner-border spinner-border-sm"></span>',e.appendChild(t)}},globalError:()=>{window.addEventListener("unhandledrejection",(async function(e){if(console.debug(e),window.bootstrap){let a=t.isNullOrWhiteSpace(e.reason)?"出错了！":e.reason;o.toast(a)}})),window.addEventListener("error",(async function(e){let t=e.message;t.startsWith("ResizeObserver")||(console.debug(e),window.bootstrap&&o.toast(t))}))},logError:(e,t)=>{console.debug(e),null!=t&&o.toast(t)},setGridColumnLoading:e=>{for(let t=0;t<e.length;t++){let a=e[t];if("#row_number"!=a.field&&1!=a.hide){null==a.cellRenderer&&(a.cellRenderer=e=>void 0===e.value?'<div class="spinner-border"></div>':e.value);break}}},setQuickFilter:(e,t)=>{e.addEventListener("input",(async function(){let e=t.gridApi||t;e&&e.updateGridOptions({quickFilterText:this.value})}))},toast:e=>{null==o.domToastContainer&&(o.domToastContainer=document.createElement("div"),o.domToastContainer.className="toast-container position-fixed bottom-0 end-0 p-4",document.body.appendChild(o.domToastContainer));let t=document.createElement("div");t.innerHTML=`\n<div class="toast-header">\n    <img src="/favicon.ico" class="rounded me-2" height="18">\n    <strong class="me-auto">消息提示</strong>\n    <button type="button" class="btn-close" data-bs-dismiss="toast"></button>\n</div>\n<div class="toast-body">${e}</div>\n`,t.className="toast",o.domToastContainer.appendChild(t);let a=new bootstrap.Toast(t);a.show(),o.domToastContainer.toast=a,t.addEventListener("hidden.bs.toast",(function(e){e.target.remove()}))},domAlert:null,alert:(e,a,n="60em")=>{null==o.domAlert&&(o.domAlert=document.createElement("div"),o.domAlert.innerHTML='\n<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title"></h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body"></div>\n        <div class="modal-footer">\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>\n        </div>\n    </div>\n</div>\n            ',o.domAlert.className="modal",document.body.appendChild(o.domAlert),o.domAlert.alert=new bootstrap.Modal(o.domAlert)),o.domAlert.querySelector(".modal-title").innerHTML=a||"消息提示",t.cssvar(o.domAlert,"--bs-modal-width",n);let r=o.domAlert.querySelector(".modal-body");r.innerHTML="";try{e="string"==typeof e?JSON.stringify(JSON.parse(e),null,2):JSON.stringify(e,null,2);let t=document.createElement("pre");t.className="m-0 fs-6",t.style.whiteSpace="pre-wrap",t.innerText=e,r.appendChild(t)}catch(t){r.innerHTML=e}o.domAlert.alert.show()},domConfirm:null,confirm:(e,a,n="30em")=>new Promise((r=>{null==o.domConfirm&&(o.domConfirm=document.createElement("div"),o.domConfirm.innerHTML='\n<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title"></h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body"></div>\n        <div class="modal-footer">\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>\n            <button type="button" class="btn btn-primary flag-ok">确定</button>\n        </div>\n    </div>\n</div>\n            ',o.domConfirm.className="modal",document.body.appendChild(o.domConfirm),o.domConfirm.confirm=new bootstrap.Modal(o.domConfirm)),o.domConfirm.querySelector(".modal-title").innerHTML=a||"消息提示",t.cssvar(o.domConfirm,"--bs-modal-width",n),o.domConfirm.querySelector(".modal-body").innerHTML=e;let l=function(){o.domConfirm.removeEventListener("hidden.bs.modal",l),r(!1)};o.domConfirm.addEventListener("hidden.bs.modal",l),o.domConfirm.querySelector(".flag-ok").onclick=()=>{o.domConfirm.removeEventListener("hidden.bs.modal",l),o.domConfirm.confirm.hide(),r(!0)},o.domConfirm.confirm.show()}))};Object.assign(window,{nrBS:o});let r={flagName:"netnr",flagResp:"uuid",flagLibs:"libs",flagSuffix:".md",flagToken:null,flagLocalUsed:!0,flagLocalPath:"/libs/index.json",flagLocalJson:null,flagProxyServer:"https://seep.eu.org/",flagProxyUsed:!1,flagTitle:document.title},i={init:async()=>{isSecureContext&&!window.webpackHotUpdatenetnr&&navigator.serviceWorker.register("/sw.js").then((e=>console.debug("SW registered: ",e))).catch((e=>console.debug("SW failed: ",e))),o.setTheme(t.isDark()?"dark":"light"),await Promise.all([l.e(307),l.e(840)]).then(l.bind(l,840));const e=await l.e(557).then(l.t.bind(l,557,23));Object.assign(window,{bootstrap:e,nrWeb:i,nrVary:r}),n.localforage=await new a({name:"nr-cache"}).init(),n.instanceUser=await new a({name:"nr-user"}).init(),await i.render(),i.bindEvent();let s=(location.hash.length>1?location.hash:location.pathname).substring(1).split("/");if(""!=s[0]&&(r.flagName=s[0]),null!=s[1]&&""!=s[1]&&(r.flagResp=s[1]),null!=s[2]&&""!=s[2]&&(r.flagLibs=s[2]),"#_local"==location.hash)r.flagLocalUsed=!0,await n.setItem("local",r.flagLocalUsed);else{let e=await n.getItem("local");null!=e&&(r.flagLocalUsed=e)}r.flagLocalUsed&&document.querySelector('[data-action="local"]').classList.add("active");let d=await n.getItem("uuid-token-github");null!=d&&d.length>10&&(r.flagToken=d,document.querySelector('[data-action="token"]').classList.add("active"));let c=await n.getItem("proxy");null!=c&&(r.flagProxyUsed=c),r.flagProxyUsed&&document.querySelector('[data-action="proxy"]').classList.add("active"),document.getElementById("style0").remove(),r.domLayout.classList.remove("invisible"),await i.load()},render:async()=>{let e=document.createElement("div");r.domLayout=e,e.className="invisible",e.innerHTML='\n<div class="container-fluid p-lg-4 pb-lg-0 py-4">\n    <div class="row">\n\n        <div class="col-auto mb-2">\n            <div class="dropdown">\n                <button class="btn btn-outline-success dropdown-toggle" data-bs-toggle="dropdown" data-bs-auto-close="false">\n                    <img class="nrg-img-avatar rounded" style="height:1.3em;width:1.3em;" src="/favicon.ico" >\n                </button>\n                <ul class="nrg-dd-user-info dropdown-menu"></ul>\n            </div>\n        </div>\n\n        <div class="col mb-2">\n            <input class="nrg-txt-filter form-control" type="search" placeholder="silent search.." data-search="" title="silent search.." />\n        </div>\n\n        <div class="col-auto mb-2">\n            <div class="btn-group">\n                <button class="nrg-btn-reload btn btn-outline-success" data-action="reload" title="重新加载">Reload</button>\n                <button type="button" class="btn btn-outline-success dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown">\n                    <span class="visually-hidden">Toggle Dropdown</span>\n                </button>\n                <ul class="nrg-dd-more dropdown-menu">\n                    <li><button class="dropdown-item" data-action="theme">主题 Theme</button></li>\n                    <li><hr class="dropdown-divider"></li>\n                    <li><button class="dropdown-item" data-action="local" title="私有化部署 Privatization deployment">本地 Local</button></li>\n                    <li><button class="dropdown-item" data-action="token">设置 Token</button></li>\n                    <li><button class="dropdown-item" data-action="proxy" title="使用代理 use proxy">代理 Proxy</button></li>\n                    <li><hr class="dropdown-divider"></li>\n                    <li><button class="dropdown-item" data-action="convert" title="转换浏览器导出的 HTML 书签">转换 Convert</button></li>\n                    <li><button class="dropdown-item" data-action="about">关于 About</button></li>\n                </ul>\n            </div>\n        </div>\n        <div class="col-12 position-relative">\n            <div class="nrg-search border rounded d-none position-absolute"></div>\n        </div>        \n    </div>\n    <div class="nrg-view row my-3"></div>\n</div>\n',document.body.appendChild(e),t.readDOM(document.body,"nrg",r)},load:async()=>{o.setLoading(r.domBtnReload),await i.viewUser(),await i.viewLink(),o.setLoading(r.domBtnReload,!0);try{let e=await n.instanceUser.getItem(`${r.flagName}:update-time`);e&&Date.now()-e>6048e5&&(await i.reqUser(r.flagName,!0),await i.reqLibs(r.flagName,r.flagResp,r.flagLibs,!0))}catch(e){}},bindEvent:()=>{document.body.addEventListener("click",(async function(e){let t=e.target;t.dataset.action&&i.triggerAction(t.dataset.action,t)})),r.domTxtFilter.addEventListener("keydown",(function(e){if(["ArrowUp","ArrowDown"].includes(e.code))e.preventDefault(),i.searchArrow(e.code);else if("Enter"==e.key){e.preventDefault();let t=r.domSearch.querySelector("a.active");t&&t.click()}})),r.domTxtFilter.addEventListener("input",(function(){i.searchLink(this.value.trim())})),document.body.addEventListener("keydown",(function(e){if("INPUT"!=document.activeElement.nodeName)if(e.ctrlKey&&["KeyQ","KeyK"].includes(e.code))e.preventDefault(),r.domTxtFilter.focus(),r.domTxtFilter.dataset.search="",r.domTxtFilter.placeholder=r.domTxtFilter.title,i.searchLink("");else if("Backspace"==e.code)e.preventDefault(),r.domTxtFilter.dataset.search.length&&(r.domTxtFilter.dataset.search=r.domTxtFilter.dataset.search.slice(0,-1)),r.domTxtFilter.placeholder=r.domTxtFilter.dataset.search.length?r.domTxtFilter.dataset.search:r.domTxtFilter.title,i.searchLink(r.domTxtFilter.dataset.search);else if("Enter"==e.key){if(e.preventDefault(),!r.domSearch.classList.contains("d-none")){let e=r.domSearch.querySelector("a.active");e&&e.click()}}else"Escape"==e.code?(e.preventDefault(),r.domTxtFilter.dataset.search.length&&(r.domTxtFilter.dataset.search="",r.domTxtFilter.placeholder=r.domTxtFilter.title,i.searchLink(""))):["ArrowUp","ArrowDown"].includes(e.code)?(e.preventDefault(),r.domTxtFilter.dataset.search.length&&i.searchArrow(e.code)):/^[a-z0-9\.\_\-\/]$/i.test(e.key)&&!e.ctrlKey&&(r.domTxtFilter.value="",document.documentElement.scrollTo(0,0),r.domTxtFilter.dataset.search+=e.key,r.domTxtFilter.placeholder=r.domTxtFilter.dataset.search,i.searchLink(r.domTxtFilter.dataset.search))}))},triggerAction:async(a,s)=>{switch(a){case"theme":o.setTheme(t.isDark()?"light":"dark");break;case"token":null==r.domDialogToken&&(r.domDialogToken=document.createElement("div"),r.domDialogToken.innerHTML='\n<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title">Token（令牌）</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body">\n            <div>Refresh after pasting</div>\n            <div>Anonymous access is limited (60 per hour)</div>\n            <input class="form-control my-3" placeholder="token" />\n            <div><a target="_blank" href="https://github.com/settings/tokens">https://github.com/settings/tokens</a></div>\n        </div>\n    </div>\n</div>',r.domDialogToken.className="modal",document.body.appendChild(r.domDialogToken),r.domDialogToken.querySelector("input").addEventListener("input",(async function(){let e=r.domDdMore.querySelector('[data-action="token"]');""==this.value.trim()?(e.classList.remove("active"),r.flagToken=null,await n.removeItem("uuid-token-github")):this.value.length>10&&(e.classList.add("active"),r.flagToken=this.value.trim(),await n.setItem("uuid-token-github",this.value.trim()))})),r.bsDialogToken=new bootstrap.Modal(r.domDialogToken)),r.domDialogToken.querySelector("input").value=r.flagToken,r.bsDialogToken.show();break;case"local":{let e=`https://github.com/${r.flagName}/${r.flagResp}`,t=`线上 GitHub (<a href="${e}">${e}</a>)`,a=new URL(r.flagLocalPath,location).href,l=`本地 Local (<a href="${a}">${a}</a>)`,i='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M448 789.312V0h128v789.312l234.688-234.624L896 640l-384 384-384-384 85.312-85.312L448 789.312z" fill="currentColor"></path></svg>',s=r.flagLocalUsed?`${l}<div class="my-2">${i}</div>${t}`:`${t}<div class="my-2">${i}</div>${l}`;await o.confirm(s,"切换 switch")&&(r.flagLocalUsed=!r.flagLocalUsed,await n.setItem("local",r.flagLocalUsed),r.domDdMore.querySelector('[data-action="local"]').classList.toggle("active"),"#_local"==location.hash&&(location.hash=""),location.reload())}break;case"proxy":r.flagProxyUsed=!r.flagProxyUsed,await n.setItem("proxy",r.flagProxyUsed),r.domDdMore.querySelector('[data-action="proxy"]').classList.toggle("active");break;case"reload":{let e=await n.instanceUser.keys();for(const t of e)t.startsWith(`${r.flagName}:`)&&await n.instanceUser.removeItem(t);await i.load()}break;case"convert":null==r.domDialogConvert&&(r.domDialogConvert=document.createElement("div"),r.domDialogConvert.innerHTML='\n<div class="modal-dialog modal-fullscreen modal-dialog-centered modal-dialog-scrollable">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title">Convert HTML bookmarks（转换书签）</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body">\n            <div class="row">\n                <div class="col-lg-6">\n                    <input type="file" class="mb-2 form-control" />\n                    <textarea class="form-control" style="height:calc(100vh - 145px);"></textarea>\n                </div>\n                <div class="col-lg-6">\n                    <div class="nrg-preview overflow-auto border rounded p-3" style="height:calc(100vh - 100px);">preview</div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>',r.domDialogConvert.className="modal",document.body.appendChild(r.domDialogConvert),r.domDialogConvert.querySelector("input").addEventListener("change",(async function(){let t=this.files[0];if(t){try{let a=await e.reader(t),n=[],o=document.createElement("div");o.innerHTML=a,n.push("# "+o.querySelector("h1").innerHTML),i.convertHtml(o,n);let s=n.join("\r\n");r.domDialogConvert.querySelector("textarea").value=s;let d=await l.e(23).then(l.bind(l,23));r.domDialogConvert.querySelector(".nrg-preview").innerHTML=d.parse(s)}catch(e){console.debug(e),o.alert("转换失败")}this.value=""}})),r.domDialogConvert.querySelector("textarea").addEventListener("input",(async function(){let e=await l.e(23).then(l.bind(l,23));r.domDialogConvert.querySelector(".nrg-preview").innerHTML=e.parse(this.value)})),r.bsDialogConvert=new bootstrap.Modal(r.domDialogConvert)),r.bsDialogConvert.show();break;case"about":{let e='\n<div>GitHub: <a href="https://github.com/netnr">https://github.com/netnr</a></div>\n<div>联系打赏: <a href="https://zme.ink">https://zme.ink</a></div>\n<hr/>\n<div class="mt-2">缓存后可离线使用</div>\n<hr/>\n<div>Fork 项目，从浏览器导出书签 HTML，再转换书签为 Markdown，保存到 libs/*.md</div>\n<div>私有化部署，更新索引文件 libs/index.json，页面再启用 本地 Local</div>\n<hr/>\n<div>uuid.fun 于 2028-11-09 8:00 到期，计划不再续费，启用子域名，<a href="https://uu.zme.ink">https://uu.zme.ink</a></div>\n';o.alert(e,"About 关于")}}},reqUser:async(e,t)=>{let a=`https://api.github.com/users/${e}`,o=`${e}:${a}`,r=await n.instanceUser.getItem(o);return(null==r||t)&&(r=await i.reqServer(a),r&&(await n.instanceUser.setItem(o,r),await n.instanceUser.setItem(`${e}:update-time`,Date.now()))),r},reqLibs:async(e,t,a,o)=>{let r=`https://api.github.com/repos/${e}/${t}/contents/${a}`,l=`${e}:${r}`,s=await n.instanceUser.getItem(l);return(null==s||o)&&(s=await i.reqServer(r),s&&await n.instanceUser.setItem(l,s)),s},reqRaw:async e=>{let a=`${r.flagName}:${e}`,o=await n.instanceUser.getItem(a);return null==o&&(o=await i.reqServer(`${e}?_${t.random()}`,{type:"text"}),o&&await n.instanceUser.setItem(a,o)),o},convertHtml:(e,t)=>{for(let a=0;a<e.children.length;a++){let n=e.children[a];switch(n.nodeName){case"H3":t.push(""),t.push("### "+n.innerHTML);break;case"DL":case"P":i.convertHtml(n,t);break;case"DT":if(1==n.children.length){let e=n.querySelector("a");t.push("- ["+e.innerHTML.replace(/`/g,"\\`")+"]("+e.href+")")}else i.convertHtml(n,t)}}},viewUser:async()=>{let e;if(r.flagLocalUsed?(r.flagLocalJson=await i.reqServer(r.flagLocalPath),r.flagLocalJson?e=r.flagLocalJson.user:o.toast("加载失败")):e=await i.reqUser(r.flagName),e){r.domImgAvatar.onerror=function(){r.domImgAvatar.src="/favicon.ico",r.domImgAvatar.onerror=!1},r.domImgAvatar.src=e.avatar_url;let t=null==e.name?e.login:`${e.login} (${e.name})`,a=null==e.bio?"":`<li><span class="dropdown-item-text" title="bio">${e.bio}</span></li>`,n=null==e.company?"":`<li><span class="dropdown-item-text" title="company">${e.company}</span></li>`,o=null==e.location?"":`<li><span class="dropdown-item-text" title="location">${e.location}</span></li>`,l=null==e.blog?"":`<li><a class="dropdown-item" title="blog" href="${e.blog}">${e.blog}</a></li>`;r.domDdUserInfo.innerHTML=`<li><a class="dropdown-item" title="name" href="https://github.com/${e.login}">${t}</a></li>\n            ${a}<li><hr class="dropdown-divider"></li>${n}${o}${l}\n            `,document.title=`${e.login} - ${r.flagTitle}`}},viewLink:async()=>{let e;if(r.flagLocalUsed?r.flagLocalJson&&(e=r.flagLocalJson.libs):e=await i.reqLibs(r.flagName,r.flagResp,r.flagLibs),e){let t=[],a=0;e.forEach((e=>{if("file"==e.type&&e.name.endsWith(r.flagSuffix)){let n=e.name.substring(0,e.name.length-r.flagSuffix.length);a++,t.push(`\n                    <div class="accordion-item">\n                        <h2 class="accordion-header">\n                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-${a}">${n}</button>\n                        </h2>\n                        <div id="collapse-${a}" class="accordion-collapse collapse show">\n                            <div class="accordion-body">${o.tsLoadingHtml}</div>\n                        </div>\n                    </div>\n                    `)}})),r.domView.innerHTML=`<div class="accordion">${t.join("")}</div>`,a=0;for(const t of e)if("file"==t.type&&t.name.endsWith(r.flagSuffix)){a++;let e=r.domView.querySelector(`#collapse-${a}`).children[0],n=await i.reqRaw(t.download_url);if(n){let t=await l.e(23).then(l.bind(l,23));e.innerHTML=t.parse(n)}else e.innerHTML=o.tsFailHtml}r.domView.dataset.ended=!0}else r.domView.innerHTML=`<div class="col-12">${o.tsFailHtml}</div>`},searchLink:e=>{if(r.domView.dataset.ended){let t=[];if(""!=e.trim()){e=e.toLowerCase();let a=r.domView.querySelectorAll("a");for(let n=0;n<a.length;n++){const o=a[n];if(`${o.href},${o.innerText},${o.title||""}`.toLowerCase().includes(e)&&(t.push(`<a class="d-flex px-3 py-2 border-top opacity-75" href="${o.href}"><span class="w-75 text-truncate">${o.href}</span><span class="w-25 text-truncate">${o.innerText}</span></a>`),t.length>7))break}}r.domSearch.innerHTML=t.join(""),t.length?(r.domSearch.classList.remove("d-none"),r.domSearch.querySelector("a").classList.add("active")):r.domSearch.classList.add("d-none")}},searchArrow:e=>{if(!r.domSearch.classList.contains("d-none")){let t=r.domSearch.querySelector("a.active"),a="ArrowDown"==e?t.nextElementSibling:t.previousElementSibling;a&&(t.classList.remove("active"),a.classList.add("active"))}},reqServer:async(e,a)=>{a=a||{},null!=r.flagToken&&r.flagToken.length>10&&!e.includes("githubusercontent")&&(a.headers=a.headers||{},a.headers.authorization=`token ${r.flagToken}`),r.flagProxyUsed&&!r.flagLocalUsed&&(e=`${r.flagProxyServer}${encodeURIComponent(e)}`);let n=await t.fetch(e,a);if(n.error)o.logError(n.error,"网络错误");else if(0==n.resp.ok)403==n.resp.status&&o.toast("请设置 Token");else if(n.resp.ok&&n.result)return n.result}};l(747),l(204),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",i.init):i.init()})()})();